import{r as i,W as S,a as t,j as a,F as j}from"./app-9c606e28.js";import{C as c,I as P}from"./InfractionsTable-2f17bdd5.js";import{C as D}from"./calendar-9f60b575.js";import{c as y}from"./createLucideIcon-ec4b2065.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],E=y("Camera",R);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],L=y("Clock",F);function A({employes:l,restaurants:v,postes:x,infractions:N}){var g,f,b;const[d,u]=i.useState(null),p=i.useRef(null),[m,h]=i.useState(!1),{data:r,setData:n,post:w,processing:_,errors:$,reset:C}=S({restaurant:"",infraction_constatee:"",poste:"",employe_id:"",photo:null,infraction_date:"",infraction_time:""}),k=e=>{e.preventDefault(),w(route("infractions.store"),{onSuccess:()=>{C(),u(null)},preserveScroll:!0})},I=e=>{const o=e.target.files[0];if(o){n("photo",o);const s=new FileReader;s.onloadend=()=>{u(s.result)},s.readAsDataURL(o)}};return t("div",{className:"max-w-3xl mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[a("h1",{className:"text-2xl font-semibold text-gray-900 mb-8",children:"Nouvelle Infraction"}),t("form",{onSubmit:k,className:"space-y-6",children:[t("div",{children:[a("label",{className:"block text-base text-gray-700 mb-2",children:"Restaurant"}),t("div",{className:"relative",children:[t("select",{value:r.restaurant,onChange:e=>n("restaurant",e.target.value),className:"w-full appearance-none rounded-lg border border-gray-300 px-4 py-3 pr-10 focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",children:[a("option",{value:"",children:"Sélectionner un restaurant"}),v.map(e=>a("option",{value:e,children:e},e))]}),a(c,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5"})]})]}),t("div",{children:[a("label",{className:"block text-base text-gray-700 mb-2",children:"Poste"}),t("div",{className:"relative",children:[t("select",{value:r.poste,onChange:e=>n("poste",e.target.value),className:"w-full appearance-none rounded-lg border border-gray-300 px-4 py-3 pr-10 focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",children:[a("option",{value:"",children:"Sélectionner un poste"}),x.map(e=>a("option",{value:e,children:e},e))]}),a(c,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5"})]})]}),t("div",{children:[a("label",{className:"block text-base text-gray-700 mb-2",children:"Employé"}),t("div",{className:"relative",children:[t("button",{type:"button",onClick:()=>h(!m),className:"w-full text-left rounded-lg border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white flex items-center justify-between",children:[t("div",{className:"flex items-center",children:[r.employe_id&&l&&t(j,{children:[((g=l.find(e=>e.id===parseInt(r.employe_id)))==null?void 0:g.profile_photo)&&a("img",{src:`https://restaurant.cucinanapoli.com/public/storage/${l.find(e=>e.id===parseInt(r.employe_id)).profile_photo}`,alt:"",className:"h-8 w-8 rounded-full mr-3 object-cover"}),t("span",{children:[(f=l.find(e=>e.id===parseInt(r.employe_id)))==null?void 0:f.first_name," "," ",(b=l.find(e=>e.id===parseInt(r.employe_id)))==null?void 0:b.last_name]})]}),!r.employe_id&&a("span",{children:"Sélectionner un employé"})]}),a(c,{className:"h-5 w-5 text-gray-400"})]}),m&&a("div",{className:"absolute z-10 w-full mt-1 bg-white rounded-lg shadow-lg max-h-60 overflow-auto",children:l.map(e=>t("div",{className:"px-4 py-2 hover:bg-gray-50 cursor-pointer flex items-center",onClick:()=>{n("employe_id",e.id),h(!1)},children:[e.profile_photo&&a("img",{src:`https://restaurant.cucinanapoli.com/public/storage/${e.profile_photo}`,alt:"",className:"h-8 w-8 rounded-full mr-3 object-cover"}),t("span",{children:[e.first_name," ",e.last_name]})]},e.id))})]})]}),t("div",{children:[a("label",{className:"block text-base text-gray-700 mb-2",children:"Infraction constatée"}),a("textarea",{value:r.infraction_constatee,onChange:e=>n("infraction_constatee",e.target.value),rows:4,className:"w-full rounded-lg border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),t("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t("div",{children:[a("label",{className:"block text-base text-gray-700 mb-2",children:"Date"}),t("div",{className:"relative",children:[a("input",{type:"date",value:r.infraction_date,onChange:e=>n("infraction_date",e.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-3 pr-10 focus:outline-none focus:ring-2 focus:ring-purple-500"}),a(D,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5"})]})]}),t("div",{children:[a("label",{className:"block text-base text-gray-700 mb-2",children:"Heure"}),t("div",{className:"relative",children:[a("input",{type:"time",value:r.infraction_time,onChange:e=>n("infraction_time",e.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-3 pr-10 focus:outline-none focus:ring-2 focus:ring-purple-500"}),a(L,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5"})]})]})]}),t("div",{children:[a("label",{className:"block text-base text-gray-700 mb-2",children:"Photo"}),a("input",{type:"file",ref:p,className:"hidden",onChange:I,accept:"image/*",capture:"environment"}),t("button",{type:"button",onClick:()=>{var e;return(e=p.current)==null?void 0:e.click()},className:"flex items-center space-x-2 rounded-lg border border-gray-300 px-4 py-3 text-gray-700 hover:bg-gray-50",children:[a(E,{className:"h-5 w-5"}),a("span",{children:"Prendre une photo"})]}),d&&a("div",{className:"mt-2",children:a("img",{src:d,alt:"Preview",className:"h-32 w-32 object-cover rounded-lg"})})]}),a("div",{className:"flex justify-center",children:a("button",{type:"submit",disabled:_,className:"px-4 sm:px-6 py-2 sm:py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2",children:"Enregistrer"})})]}),a(P,{infractions:N,employes:l})]})}export{A as default};
