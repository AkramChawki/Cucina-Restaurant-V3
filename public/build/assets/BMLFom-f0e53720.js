import{j as r,R as ne,r as h,a as o,f as O}from"./app-5eacb11b.js";import{c as S}from"./createLucideIcon-789b60ef.js";import{C as oe}from"./calendar-a8458a3a.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],le=S("ChevronsUpDown",ie);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=S("CircleAlert",ce);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],me=S("CircleCheckBig",ue);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],pe=S("CirclePlus",ge);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],fe=S("Save",he);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],be=S("Trash2",ye);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ve=S("X",xe),Ne=({message:d,type:m="success",onClose:l})=>(h.useEffect(()=>{const N=setTimeout(()=>{l()},3e3);return()=>clearTimeout(N)},[l]),o("div",{className:`fixed top-4 right-4 flex items-center p-4 mb-4 rounded-lg shadow-lg ${m==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:[r("div",{className:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8",children:m==="success"?r(me,{className:"w-5 h-5 text-green-600"}):r(de,{className:"w-5 h-5 text-red-600"})}),r("div",{className:"ml-3 text-sm font-normal",children:d}),r("button",{onClick:l,className:"ml-4 -mx-1.5 -my-1.5 bg-transparent text-gray-400 hover:text-gray-900 rounded-lg p-1.5 inline-flex h-8 w-8",children:r(ve,{className:"w-5 h-5"})})]})),we=({toasts:d,removeToast:m})=>r("div",{className:"fixed top-0 right-0 z-50 p-4 space-y-4",children:d.map(l=>r(Ne,{message:l.message,type:l.type,onClose:()=>m(l.id)},l.id))}),Ce=()=>{const[d,m]=ne.useState([]);return{toasts:d,addToast:(b,x="success")=>{const c=Date.now();m(T=>[...T,{id:c,message:b,type:x}])},removeToast:b=>{m(x=>x.filter(c=>c.id!==b))}}},I={gastro:["Mozzarella Milka","Creme Fraîche","PERLA CERISE","Mozzarella cerise"],giada:["Mozzarella","Stracciatella","Buratta","Ricotta"],legume:["Roquette","EPINARD","Tomate cerise","Poivron Rouge","Poivron vert","CHAMPIGNON","CITRON","ORANGUE","CONCOMBRE","AIL","Basilic","Courgette","OIGNON"],boisson:["Coca","Coca Zero","Hawaei","Sprite","POMS","Citron","Tonic"]},De=["Kg","KG","250G","unite","L","Botte","BROT","paquet de 24 U","Pot de 1 kg"],_=d=>{if(!d)return"";try{const m=d instanceof Date?d:new Date(d),l=m.getTimezoneOffset()*6e4;return new Date(m.getTime()-l).toISOString().split("T")[0]}catch(m){return console.error("Error formatting date:",m),""}},B=d=>{switch(d){case"gastro":return"GASTRO";case"giada":return"GIADA";case"legume":return"Legume";case"boisson":return"COCA COLA";default:return""}},ke=({value:d,onChange:m,disabled:l})=>{const[N,b]=h.useState(!1),x=h.useRef(null),c=new Date(d);h.useEffect(()=>{const i=u=>{x.current&&!x.current.contains(u.target)&&b(!1)};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[x]);const T=new Date().getFullYear(),v=Array.from({length:6},(i,u)=>T-u),A=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],p=i=>{const u=new Date(c.getFullYear(),i);m(u),b(!1)},$=i=>{const u=new Date(i,c.getMonth());m(u),b(!1)};return o("div",{className:"relative",ref:x,children:[o("button",{type:"button",onClick:()=>!l&&b(!N),className:`flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white text-sm ${l?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,disabled:l,children:[r(oe,{className:"w-4 h-4 mr-2 text-gray-500"}),o("span",{children:[A[c.getMonth()]," ",c.getFullYear()]}),r(le,{className:"w-4 h-4 ml-2 text-gray-500"})]}),N&&o("div",{className:"absolute z-50 mt-1 bg-white border border-gray-200 rounded-md shadow-lg p-2 w-64",children:[o("div",{className:"mb-2",children:[r("div",{className:"font-medium text-gray-700 mb-1",children:"Mois"}),r("div",{className:"grid grid-cols-3 gap-1",children:A.map((i,u)=>r("button",{type:"button",className:`text-sm p-1 rounded ${c.getMonth()===u?"bg-green-500 text-white":"hover:bg-gray-100"}`,onClick:()=>p(u),children:i.substring(0,3)},i))})]}),o("div",{children:[r("div",{className:"font-medium text-gray-700 mb-1",children:"Année"}),r("div",{className:"grid grid-cols-3 gap-1",children:v.map(i=>r("button",{type:"button",className:`text-sm p-1 rounded ${c.getFullYear()===i?"bg-green-500 text-white":"hover:bg-gray-100"}`,onClick:()=>$(i),children:i},i))})]})]})]})};function Te({restaurant:d,currentMonth:m,existingEntries:l=[],types:N={},currentType:b=""}){const{toasts:x,addToast:c,removeToast:T}=Ce(),[v,A]=h.useState(new Date(m.year,m.month-1)),[p,$]=h.useState(b),[i,u]=h.useState(!1),[w,D]=h.useState({}),j=h.useRef(!0),P=h.useRef(l),[X,Y]=h.useState(null),[f,Q]=h.useState({key:"date",direction:"ascending"}),z=()=>({id:Date.now()+Math.floor(Math.random()*1e3),fournisseur:B(p),designation:"",quantity:"",price:"",unite:"",date:_(new Date),type:p,total_ttc:0,isNew:!0,isSaving:!1,hasChanges:!1}),[y,C]=h.useState([z()]),E=y.some(e=>e.hasChanges),W=e=>e.reduce((a,t)=>{const n=t.date;return n&&(a[n]||(a[n]={rows:[],total:0}),a[n].rows.push(t),a[n].total+=parseFloat(t.total_ttc)||0),a},{});h.useEffect(()=>{if(j.current){j.current=!1;return}const e=JSON.stringify(P.current)!==JSON.stringify(l);if(P.current=l,!!e)if(l&&l.length>0){const s=l.map((a,t)=>({id:Date.now()+t,fournisseur:a.fournisseur||B(a.type),designation:a.designation||"",quantity:a.quantity||"",price:a.price||"",unite:a.unite||"",date:_(a.date),type:a.type||p,total_ttc:parseFloat(a.total_ttc)||0,isNew:!1,isSaving:!1,hasChanges:!1,originalId:a.id}));C(s)}else C([z()])},[l]);const Z=[...y].sort((e,s)=>{if(!e[f.key]||!s[f.key])return 0;if(f.key==="date"){const n=new Date(e.date),g=new Date(s.date);return f.direction==="ascending"?n-g:g-n}const a=e[f.key].toString().toLowerCase(),t=s[f.key].toString().toLowerCase();return a<t?f.direction==="ascending"?-1:1:a>t?f.direction==="ascending"?1:-1:0}),V=e=>{let s="ascending";f.key===e&&f.direction==="ascending"&&(s="descending"),Q({key:e,direction:s})},K=e=>f.key!==e?null:r("span",{className:"ml-1",children:f.direction==="ascending"?"▲":"▼"}),L=(e,s)=>{const a=parseFloat(e)||0,t=parseFloat(s)||0;return(a*t).toFixed(2)},R=e=>{if(!e)return!1;const s=new Date(e);return s.getMonth()+1!==v.getMonth()+1||s.getFullYear()!==v.getFullYear()},G=()=>{C(e=>[...e,z()])},ee=async e=>{const s=y.find(a=>a.id===e);if(s){if(y.length<=1){c("Impossible de supprimer la seule ligne","warning");return}if(!s.isNew&&s.originalId){if(!confirm("Êtes-vous sûr de vouloir supprimer cette ligne?"))return;D(a=>({...a,[e]:!0}));try{O.post(route("bml.delete"),{id:s.originalId,restaurant_id:d.id},{preserveScroll:!0,preserveState:!1,onSuccess:()=>{},onError:a=>{console.error("Delete error:",a),c("Erreur lors de la suppression","error"),D(t=>({...t,[e]:!1}))}})}catch(a){c("Erreur lors de la suppression","error"),console.error("Error deleting row:",a),D(t=>({...t,[e]:!1}))}}else C(a=>a.filter(t=>t.id!==e)),D(a=>{const t={...a};return delete t[e],t})}},U=async e=>{const s=y.find(a=>a.id===e);if(s){if(!s.date||!s.fournisseur||!s.designation||!s.quantity||!s.price||!s.unite){c("Veuillez remplir tous les champs obligatoires.","error");return}if(R(s.date)){const t=new Date(s.date).toLocaleDateString("fr-FR");if(!confirm(`Attention: La date sélectionnée (${t}) est en dehors du mois actuel. Cette entrée sera automatiquement placée dans le mois correspondant à sa date. Voulez-vous continuer?`))return}C(a=>a.map(t=>t.id===e?{...t,isSaving:!0}:t)),D(a=>({...a,[e]:!0}));try{const a=new Date(s.date),t={...s,date:_(a),type:p||s.type||"gastro",total_ttc:L(s.quantity,s.price)},n={restaurant_id:d.id,rows:[t],month:a.getMonth()+1,year:a.getFullYear(),type:p||"gastro",day_total:parseFloat(t.total_ttc).toFixed(2)};await O.post(route("bml.update-value"),n,{preserveScroll:!0,preserveState:!1,onSuccess:()=>{},onError:g=>{console.error("Save error:",g),c("Erreur lors de l'enregistrement","error"),C(q=>q.map(F=>F.id===e?{...F,isSaving:!1}:F)),D(q=>({...q,[e]:!1}))}})}catch(a){console.error("Error saving row:",a),c("Erreur lors de l'enregistrement","error"),C(t=>t.map(n=>n.id===e?{...n,isSaving:!1}:n)),D(t=>({...t,[e]:!1}))}}},k=(e,s,a)=>{C(t=>t.map(n=>{if(n.id===e){const g={...n,[s]:a,hasChanges:!0};return s==="type"&&(g.fournisseur=B(a)),(s==="quantity"||s==="price")&&(g.total_ttc=L(s==="quantity"?a:n.quantity,s==="price"?a:n.price)),g}return n}))},te=e=>{try{const s=e.target.value;if(console.log("Type changed to:",s),E&&!confirm("Vous avez des modifications non enregistrées. Voulez-vous continuer sans enregistrer?"))return;$(s),u(!0);const a=s===""?null:s,t=route("bml.show",[d.slug]);console.log("Navigating to:",t,"with type:",a),O.get(t,{month:v.getMonth()+1,year:v.getFullYear(),type:a},{preserveScroll:!0,preserveState:!0,onSuccess:n=>{console.log("Navigation successful",n),u(!1)},onError:n=>{console.error("Navigation error:",n),u(!1),c("Erreur lors du chargement des données.","error")}})}catch(s){console.error("Error in handleTypeChange:",s),u(!1),c("Une erreur est survenue lors du changement de type.","error")}},re=e=>{E&&!confirm("Vous avez des modifications non enregistrées. Voulez-vous continuer sans enregistrer?")||(A(e),u(!0),O.get(route("bml.show",[d.slug]),{month:e.getMonth()+1,year:e.getFullYear(),type:p},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{u(!1)},onError:()=>{u(!1),c("Erreur lors du chargement des données.","error")}}))},H=()=>{const e=W(y);return Object.entries(e).map(([s,a])=>({date:s,total:a.total.toFixed(2)})).sort((s,a)=>s.date.localeCompare(a.date))},se=e=>{e.preventDefault();const s=y.filter(n=>n.hasChanges);if(s.length===0){c("Aucune modification à enregistrer.","info");return}if(!confirm(`Voulez-vous enregistrer ${s.length} ligne(s) modifiée(s)?`))return;const a=s.map(n=>{const g=new Date(n.date);return{...n,date:_(g),type:p||n.type||"gastro",total_ttc:L(n.quantity,n.price)}}),t={restaurant_id:d.id,rows:a,month:v.getMonth()+1,year:v.getFullYear(),type:p||"gastro",day_total:a.reduce((n,g)=>n+parseFloat(g.total_ttc),0).toFixed(2)};u(!0),O.post(route("bml.store"),t,{preserveScroll:!0,preserveState:!1,onSuccess:()=>{},onError:n=>{console.error("Save error:",n),c("Erreur lors de l'enregistrement","error"),u(!1)}})},M=(e,s,a,t)=>{if(e.key==="Enter"){e.preventDefault(),U(s);return}if(e.key==="Tab"&&!e.shiftKey){const n=["date","fournisseur","designation","quantity","unite","price"];n.indexOf(a)===n.length-1&&(e.preventDefault(),t===y.length-1&&G(),setTimeout(()=>{const F=t+1;if(F<y.length){const ae=y[F].id,J=document.querySelector(`input[name="date-${ae}"]`);J&&J.focus()}},0))}};return o("div",{className:"p-4 sm:p-6",children:[r("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:o("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[o("div",{className:"flex-1 flex items-center gap-4",children:[o("div",{children:[r("h2",{className:"text-lg font-semibold text-gray-900",children:"BML"}),o("p",{className:"mt-1 text-sm text-gray-600",children:[d.name," -"," ",v.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})]})]}),r("div",{className:"relative",children:o("select",{value:p,onChange:te,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 py-2 pl-3 pr-10 text-base",disabled:i,children:[r("option",{value:"",children:"Tous les types"}),Object.entries(N).map(([e,s])=>r("option",{value:s,children:e},s))]})})]}),r("div",{className:"flex-shrink-0",children:r(ke,{value:v,onChange:re,disabled:i})})]})}),r("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:o("form",{onSubmit:se,children:[i&&r("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",children:o("div",{className:"text-center",children:[r("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"}),r("p",{className:"mt-2 text-gray-600",children:"Chargement en cours..."})]})}),r("div",{className:"overflow-x-auto",children:o("table",{className:"min-w-full divide-y divide-gray-200",children:[r("thead",{className:"bg-gray-50",children:o("tr",{children:[r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky top-0 cursor-pointer",onClick:()=>V("date"),children:o("div",{className:"flex items-center",children:["Date ",K("date")]})}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky top-0",children:"Fournisseur"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky top-0 cursor-pointer",onClick:()=>V("designation"),children:o("div",{className:"flex items-center",children:["Designation"," ",K("designation")]})}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky top-0",children:"Quantité"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky top-0",children:"Unité"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky top-0",children:"Prix"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky top-0",children:"Total TTC"}),r("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50 sticky top-0",children:"Actions"})]})}),o("tbody",{className:"bg-white divide-y divide-gray-200",children:[Z.map((e,s)=>{var a;return o("tr",{className:`hover:bg-gray-50 transition-colors duration-150 ${e.hasChanges?"bg-blue-50":""}`,children:[o("td",{className:`px-4 py-2 ${R(e.date)?"bg-yellow-50":""}`,children:[o("div",{className:"relative",children:[r("input",{name:`date-${e.id}`,type:"date",value:e.date||"",onChange:t=>k(e.id,"date",t.target.value),onKeyDown:t=>M(t,e.id,"date",s),className:`w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-sm transition-colors duration-150 ${R(e.date)?"border-yellow-400 bg-yellow-50":""} ${e.hasChanges?"border-blue-300":""}`,required:!0,disabled:i||w[e.id],max:_(new Date)}),R(e.date)&&r("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:r("svg",{className:"h-5 w-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:r("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})})]}),R(e.date)&&r("div",{className:"text-xs text-yellow-600 mt-1",children:"Date hors du mois sélectionné"})]}),r("td",{className:"px-4 py-2",children:r("input",{type:"text",value:e.fournisseur,onChange:t=>k(e.id,"fournisseur",t.target.value),onKeyDown:t=>M(t,e.id,"fournisseur",s),className:`w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-sm transition-colors duration-150 ${e.hasChanges?"border-blue-300":""}`,required:!0,disabled:!0})}),o("td",{className:"px-4 py-2 relative",children:[r("input",{id:`designation-${e.id}`,type:"text",value:e.designation,onChange:t=>k(e.id,"designation",t.target.value),onKeyDown:t=>M(t,e.id,"designation",s),className:`w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-sm transition-colors duration-150 ${e.hasChanges?"border-blue-300":""}`,required:!0,disabled:i||w[e.id],autoComplete:"off",onFocus:()=>Y(e.id),onBlur:()=>{setTimeout(()=>Y(null),200)}}),!i&&X===e.id&&o("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white border border-gray-200 rounded-md shadow-md z-50 max-h-40 overflow-y-auto",children:[(a=I[p])==null?void 0:a.map((t,n)=>r("div",{className:"px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm",onMouseDown:g=>{g.preventDefault(),k(e.id,"designation",t)},children:t},n)),(!I[p]||I[p].length===0)&&r("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Aucune suggestion"})]})]}),r("td",{className:"px-4 py-2",children:r("input",{type:"number",value:e.quantity,onChange:t=>k(e.id,"quantity",t.target.value),onKeyDown:t=>M(t,e.id,"quantity",s),className:`w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-sm transition-colors duration-150 ${e.hasChanges?"border-blue-300":""}`,min:"0",step:"0.01",required:!0,disabled:i||w[e.id]})}),r("td",{className:"px-4 py-2",children:o("div",{className:"relative",children:[r("input",{type:"text",list:"unite-options",value:e.unite,onChange:t=>k(e.id,"unite",t.target.value),onKeyDown:t=>M(t,e.id,"unite",s),className:`w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-sm transition-colors duration-150 ${e.hasChanges?"border-blue-300":""}`,required:!0,disabled:i||w[e.id]}),r("datalist",{id:"unite-options",children:De.map((t,n)=>r("option",{value:t},n))})]})}),r("td",{className:"px-4 py-2",children:r("input",{type:"number",value:e.price,onChange:t=>k(e.id,"price",t.target.value),onKeyDown:t=>M(t,e.id,"price",s),className:`w-full border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500 text-sm transition-colors duration-150 ${e.hasChanges?"border-blue-300":""}`,min:"0",step:"0.01",required:!0,disabled:i||w[e.id]})}),r("td",{className:"px-4 py-2",children:o("div",{className:"text-sm text-gray-900 font-medium",children:[parseFloat(e.total_ttc).toFixed(2)," ","MAD"]})}),r("td",{className:"px-4 py-2",children:o("div",{className:"flex space-x-2",children:[r("button",{type:"button",onClick:()=>U(e.id),className:`text-blue-600 hover:text-blue-800 ${e.hasChanges?"":"opacity-50 cursor-not-allowed"}`,disabled:i||!e.hasChanges||w[e.id],title:"Enregistrer cette ligne",children:w[e.id]?r("div",{className:"h-5 w-5 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"}):r(fe,{className:"h-5 w-5"})}),r("button",{type:"button",onClick:()=>ee(e.id),className:"text-red-600 hover:text-red-800 disabled:opacity-50",disabled:i||y.length<=1||w[e.id],title:"Supprimer cette ligne",children:r(be,{className:"h-5 w-5"})})]})})]},e.id)}),r("tr",{className:"bg-gray-50",children:o("td",{colSpan:"8",className:"px-4 py-3",children:[r("div",{className:"font-semibold text-gray-900 mb-2",children:"Totaux par jour"}),r("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:H().map(e=>o("div",{className:"flex justify-between items-center bg-white p-2 rounded-md shadow-sm",children:[r("span",{className:"text-sm text-gray-600",children:new Date(e.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}),o("span",{className:"font-medium text-gray-900",children:[parseFloat(e.total).toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2})," ","MAD"]})]},e.date))}),o("div",{className:"mt-3 flex justify-end items-center border-t pt-2",children:[r("span",{className:"text-sm font-medium text-gray-600 mr-2",children:"Total du mois:"}),o("span",{className:"text-lg font-bold text-gray-900",children:[H().reduce((e,s)=>e+parseFloat(s.total),0).toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2})," ","MAD"]})]})]})})]})]})}),o("div",{className:"p-4 flex justify-between items-center bg-gray-50",children:[o("button",{type:"button",onClick:G,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",disabled:i,children:[r(pe,{className:"h-4 w-4 mr-2"}),"Ajouter une ligne"]}),r("button",{type:"submit",className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 ${E?"":"opacity-50 cursor-not-allowed"}`,disabled:i||!E,children:i?"Enregistrement...":"Enregistrer tout"})]})]})}),r(we,{toasts:x,removeToast:T})]})}export{Te as default};
