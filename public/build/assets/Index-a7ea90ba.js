import{r as u,W as v,a,j as e}from"./app-2c16818b.js";import{c as w}from"./createLucideIcon-be761533.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],k=w("Camera",_);function S({employes:p,restaurants:h,postes:g,infractions:f}){const[d,l]=u.useState(null),c=u.useRef(null),{data:s,setData:n,post:x,processing:m,errors:r,reset:y}=v({restaurant:"",infraction_constatee:"",poste:"",employe_id:"",photo:null,infraction_date:"",infraction_time:""}),b=t=>{t.preventDefault(),x(route("infractions.store"),{onSuccess:()=>{y(),l(null)},preserveScroll:!0})},N=t=>{const i=t.target.files[0];if(i){n("photo",i);const o=new FileReader;o.onloadend=()=>{l(o.result)},o.readAsDataURL(i)}};return a("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[e("div",{className:"bg-white shadow-sm rounded-lg",children:a("div",{className:"p-6",children:[e("h2",{className:"text-lg font-medium text-gray-900 mb-6",children:"Nouvelle Infraction"}),a("form",{onSubmit:b,className:"space-y-6",children:[a("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Restaurant"}),a("select",{value:s.restaurant,onChange:t=>n("restaurant",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e("option",{value:"",children:"Sélectionner un restaurant"}),h.map(t=>e("option",{value:t,children:t},t))]}),r.restaurant&&e("p",{className:"mt-1 text-sm text-red-600",children:r.restaurant})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Poste"}),a("select",{value:s.poste,onChange:t=>n("poste",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e("option",{value:"",children:"Sélectionner un poste"}),g.map(t=>e("option",{value:t,children:t},t))]}),r.poste&&e("p",{className:"mt-1 text-sm text-red-600",children:r.poste})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Employé"}),a("select",{value:s.employe_id,onChange:t=>n("employe_id",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e("option",{value:"",children:"Sélectionner un employé"}),p.map(t=>e("div",{className:"flex items-center",children:a("option",{value:t.id,children:[t.first_name," ",t.last_name]})},t.id))]}),r.employe_id&&e("p",{className:"mt-1 text-sm text-red-600",children:r.employe_id})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Infraction constatée"}),e("textarea",{value:s.infraction_constatee,onChange:t=>n("infraction_constatee",t.target.value),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),r.infraction_constatee&&e("p",{className:"mt-1 text-sm text-red-600",children:r.infraction_constatee})]}),a("div",{className:"grid grid-cols-2 gap-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),e("input",{type:"date",value:s.infraction_date,onChange:t=>n("infraction_date",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),r.infraction_date&&e("p",{className:"mt-1 text-sm text-red-600",children:r.infraction_date})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Heure"}),e("input",{type:"time",value:s.infraction_time,onChange:t=>n("infraction_time",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),r.infraction_time&&e("p",{className:"mt-1 text-sm text-red-600",children:r.infraction_time})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Photo"}),e("input",{type:"file",ref:c,className:"hidden",onChange:N,accept:"image/*",capture:"environment"}),a("button",{type:"button",onClick:()=>{var t;return(t=c.current)==null?void 0:t.click()},className:"mt-1 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e(k,{className:"h-5 w-5 mr-2"}),"Prendre une photo"]}),d&&e("div",{className:"mt-2",children:e("img",{src:d,alt:"Preview",className:"h-32 w-32 object-cover rounded-lg"})}),r.photo&&e("p",{className:"mt-1 text-sm text-red-600",children:r.photo})]})]}),e("div",{className:"flex justify-end",children:e("button",{type:"submit",disabled:m,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:m?"Enregistrement...":"Enregistrer"})})]})]})}),e("div",{className:"mt-8 bg-white shadow-sm rounded-lg",children:a("div",{className:"p-6",children:[a("div",{className:"flex justify-between items-center mb-6",children:[e("h2",{className:"text-lg font-medium text-gray-900",children:"Liste des infractions"}),a("form",{action:route("infractions.report"),method:"GET",className:"flex gap-4",children:[e("input",{type:"date",name:"date_from",className:"rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),e("input",{type:"date",name:"date_to",className:"rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),e("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Générer Rapport"})]})]}),e("div",{className:"overflow-x-auto",children:a("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:a("tr",{children:[e("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Restaurant"}),e("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Poste"}),e("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employé"}),e("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Infraction"}),e("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Heure"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(t=>a("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:t.restaurant}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t.poste}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a("div",{className:"flex items-center",children:[t.employe.profile_photo&&e("img",{src:`/storage/${t.employe.profile_photo}`,alt:"",className:"h-8 w-8 rounded-full mr-2"}),a("span",{children:[t.employe.first_name," ",t.employe.last_name]})]})}),e("td",{className:"px-6 py-4",children:t.infraction_constatee}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t.infraction_date}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t.infraction_time})]},t.id))})]})})]})})]})}export{S as default};
