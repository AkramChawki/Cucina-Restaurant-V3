import{j as e,i as C,r as p,a as n,f as b}from"./app-cf5133c4.js";import{c as m}from"./createLucideIcon-02e80c65.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],q=m("CircleAlert",T);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],S=m("CircleCheckBig",M);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],D=m("CirclePlus",_);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],L=m("Trash2",j);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],F=m("X",$),R=({message:c,type:a="success",onClose:s})=>(p.useEffect(()=>{const g=setTimeout(()=>{s()},3e3);return()=>clearTimeout(g)},[s]),n("div",{className:`fixed top-4 right-4 flex items-center p-4 mb-4 rounded-lg shadow-lg ${a==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:[e("div",{className:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8",children:a==="success"?e(S,{className:"w-5 h-5 text-green-600"}):e(q,{className:"w-5 h-5 text-red-600"})}),e("div",{className:"ml-3 text-sm font-normal",children:c}),e("button",{onClick:s,className:"ml-4 -mx-1.5 -my-1.5 bg-transparent text-gray-400 hover:text-gray-900 rounded-lg p-1.5 inline-flex h-8 w-8",children:e(F,{className:"w-5 h-5"})})]})),A=({toasts:c,removeToast:a})=>e("div",{className:"fixed top-0 right-0 z-50 p-4 space-y-4",children:c.map(s=>e(R,{message:s.message,type:s.type,onClose:()=>a(s.id)},s.id))}),B=()=>{const[c,a]=C.useState([]);return{toasts:c,addToast:(d,u="success")=>{const i=Date.now();a(f=>[...f,{id:i,message:d,type:u}])},removeToast:d=>{a(u=>u.filter(i=>i.id!==d))}}};function z({restaurant:c,currentMonth:a,existingEntries:s}){const{toasts:g,addToast:d,removeToast:u}=B(),[i,f]=p.useState(new Date(a.year,a.month-1)),[o,l]=p.useState([{id:1,fournisseur:"",designation:"",quantity:"",price:""}]);p.useEffect(()=>{if(s&&s.length>0){const t=s.map((r,y)=>({id:y+1,fournisseur:r.fournisseur,designation:r.designation,quantity:r.quantity,price:r.price}));l(t)}else l([{id:1,fournisseur:"",designation:"",quantity:"",price:""}])},[s,i]);const v=()=>{const t={id:o.length+1,fournisseur:"",designation:"",quantity:"",price:""};l([...o,t])},N=t=>{o.length>1&&l(o.filter(r=>r.id!==t))},h=(t,r,y)=>{l(o.map(x=>x.id===t?{...x,[r]:y}:x))},w=t=>{t.preventDefault(),b.post(route("bml.update-value"),{restaurant_id:c.id,rows:o,month:i.getMonth()+1,year:i.getFullYear()},{preserveScroll:!0,onSuccess:()=>{d("Les données ont été enregistrées avec succès.","success"),(!s||s.length===0)&&l([{id:1,fournisseur:"",designation:"",quantity:"",price:""}])},onError:r=>{d("Une erreur est survenue lors de l'enregistrement.","error")}})},k=t=>{const r=new Date(t.target.value);f(r),b.get(route("BL.show",[c.slug]),{month:r.getMonth()+1,year:r.getFullYear()},{preserveScroll:!0,preserveState:!0})};return n("div",{className:"p-4 sm:p-6",children:[e("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:n("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[n("div",{className:"flex-1",children:[e("h2",{className:"text-lg font-semibold text-gray-900",children:"BML"}),n("p",{className:"mt-1 text-sm text-gray-600",children:[c.name," - ",i.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})]})]}),e("div",{className:"flex-shrink-0",children:e("input",{type:"month",value:`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`,onChange:k,className:"block w-full sm:w-auto border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500"})})]})}),e("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n("form",{onSubmit:w,children:[e("div",{className:"overflow-x-auto",children:n("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:n("tr",{children:[e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fournisseur"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Designation"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantité"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prix"}),e("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(t=>n("tr",{children:[e("td",{className:"px-4 py-2",children:e("input",{type:"text",value:t.fournisseur,onChange:r=>h(t.id,"fournisseur",r.target.value),className:"w-full border-gray-300 rounded-sm focus:ring-green-500 focus:border-green-500 text-sm",required:!0})}),e("td",{className:"px-4 py-2",children:e("input",{type:"text",value:t.designation,onChange:r=>h(t.id,"designation",r.target.value),className:"w-full border-gray-300 rounded-sm focus:ring-green-500 focus:border-green-500 text-sm",required:!0})}),e("td",{className:"px-4 py-2",children:e("input",{type:"number",value:t.quantity,onChange:r=>h(t.id,"quantity",r.target.value),className:"w-full border-gray-300 rounded-sm focus:ring-green-500 focus:border-green-500 text-sm",min:"0",step:"0.01",required:!0})}),e("td",{className:"px-4 py-2",children:e("input",{type:"number",value:t.price,onChange:r=>h(t.id,"price",r.target.value),className:"w-full border-gray-300 rounded-sm focus:ring-green-500 focus:border-green-500 text-sm",min:"0",step:"0.01",required:!0})}),e("td",{className:"px-4 py-2",children:e("button",{type:"button",onClick:()=>N(t.id),className:"text-red-600 hover:text-red-800",children:e(L,{className:"h-5 w-5"})})})]},t.id))})]})}),n("div",{className:"p-4 flex justify-between items-center bg-gray-50",children:[n("button",{type:"button",onClick:v,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e(D,{className:"h-4 w-4 mr-2"}),"Ajouter une ligne"]}),e("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Enregistrer"})]})]})}),e(A,{toasts:g,removeToast:u})]})}export{z as default};
